# ç¬¬äºŒé˜¶æ®µï¼šMVPé‡åŒ–æ¡†æ¶ï¼ˆç²¾ç®€ç‰ˆï¼‰

> **ç›®æ ‡**: 3æ­¥è·‘é€šæœ€å°å¯è¡Œé‡åŒ–ç³»ç»Ÿï¼šæ•°æ®â†’ç­–ç•¥â†’å›æµ‹
> **é¢„è®¡æ—¶é—´**: 1-2å°æ—¶
> **è®¾è®¡ç†å¿µ**: å…ˆè·‘é€šï¼Œå†ä¼˜åŒ–ï¼Œæ‹’ç»è¿‡åº¦è®¾è®¡

## ğŸš€ æ ¸å¿ƒæ­¥éª¤

### ç¬¬1æ­¥ï¼šæ•°æ®æ¨¡å— (30åˆ†é’Ÿ)
```bash
# åˆ›å»ºæ•°æ®æ¨¡å—
mkdir -p pulse_trader/data
touch pulse_trader/data/__init__.py
touch pulse_trader/data/source.py
```

**pulse_trader/data/source.py**
```python
import tushare as ts
import pandas as pd
import os

class TushareDataSource:
    def __init__(self):
        token = os.getenv('TUSHARE_TOKEN')
        if not token:
            raise ValueError("è¯·è®¾ç½®TUSHARE_TOKENç¯å¢ƒå˜é‡")
        ts.set_token(token)
        self.pro = ts.pro_api()

    def get_data(self, symbol: str, start: str, end: str):
        df = self.pro.daily(ts_code=symbol, start_date=start, end_date=end)
        df['trade_date'] = pd.to_datetime(df['trade_date'])
        return df.sort_values('trade_date').set_index('trade_date')[['open','high','low','close','vol']]

    def latest_price(self, symbol: str):
        df = self.get_data(symbol, "20240101", "20241231")
        return df['close'].iloc[-1]
```

### ç¬¬2æ­¥ï¼šç­–ç•¥æ¨¡å— (30åˆ†é’Ÿ)
```bash
mkdir -p pulse_trader/strategies
touch pulse_trader/strategies/__init__.py
touch pulse_trader/strategies/ma_cross.py
```

**pulse_trader/strategies/ma_cross.py**
```python
import pandas as pd

class MACrossStrategy:
    def __init__(self, fast=5, slow=20):
        self.fast = fast
        self.slow = slow

    def generate_signals(self, data):
        df = data.copy()
        df['ma_fast'] = df['close'].rolling(self.fast).mean()
        df['ma_slow'] = df['close'].rolling(self.slow).mean()
        df['signal'] = 0
        df.loc[df['ma_fast'] > df['ma_slow'], 'signal'] = 1
        df.loc[df['ma_fast'] <= df['ma_slow'], 'signal'] = -1
        return df
```

### ç¬¬3æ­¥ï¼šå›æµ‹æ¨¡å— (30åˆ†é’Ÿ)
```bash
mkdir -p pulse_trader/backtest
touch pulse_trader/backtest/__init__.py
touch pulse_trader/backtest/engine.py
```

**pulse_trader/backtest/engine.py**
```python
import pandas as pd

class BacktestEngine:
    def __init__(self, capital=100000):
        self.capital = capital
        self.position = 0
        self.trades = []

    def run(self, data_with_signals):
        for date, row in data_with_signals.iterrows():
            price = row['close']
            signal = row['signal']

            if signal == 1 and self.position == 0:  # ä¹°å…¥
                shares = int(self.capital / price)
                self.position = shares
                self.capital = 0

            elif signal == -1 and self.position > 0:  # å–å‡º
                self.capital = self.position * price
                self.position = 0

        return self.capital + (self.position * data_with_signals['close'].iloc[-1])

def performance_metrics(final_value, initial_capital, days):
    total_return = (final_value - initial_capital) / initial_capital
    annual_return = (1 + total_return) ** (252 / days) - 1
    return {
        'total_return': total_return,
        'annual_return': annual_return,
        'final_value': final_value
    }
```

## ğŸ§ª é›†æˆæµ‹è¯•

### æµ‹è¯•è„šæœ¬
```python
# scripts/mvp_test.py
import sys, os
sys.path.append('.')

# 1. æµ‹è¯•æ•°æ®è·å–
from pulse_trader.data.source import TushareDataSource
data_source = TushareDataSource()
data = data_source.get_data("000001.SZ", "20240101", "20240331")
print(f"æ•°æ®å½¢çŠ¶: {data.shape}")

# 2. æµ‹è¯•ç­–ç•¥
from pulse_trader.strategies.ma_cross import MACrossStrategy
strategy = MACrossStrategy()
signals = strategy.generate_signals(data)
print(f"ä¿¡å·åˆ†å¸ƒ: {signals['signal'].value_counts()}")

# 3. æµ‹è¯•å›æµ‹
from pulse_trader.backtest.engine import BacktestEngine, performance_metrics
engine = BacktestEngine()
final_value = engine.run(signals)
metrics = performance_metrics(final_value, 100000, len(data))

print(f"æ€»æ”¶ç›Š: {metrics['total_return']:.2%}")
print(f"å¹´åŒ–æ”¶ç›Š: {metrics['annual_return']:.2%}")
print(f"æœ€ç»ˆä»·å€¼: {metrics['final_value']:.2f}")
```

### è¿è¡Œæµ‹è¯•
```bash
# è®¾ç½®Tushare tokenï¼ˆéœ€è¦å»tushare.proæ³¨å†Œè·å–ï¼‰
export TUSHARE_TOKEN=your_token_here

# è¿è¡Œæµ‹è¯•
python scripts/mvp_test.py
```

## âœ… æˆåŠŸæ ‡å‡†

è¿è¡Œæµ‹è¯•ååº”è¯¥çœ‹åˆ°ï¼š
- æ•°æ®å½¢çŠ¶: (60, 5) âœ“
- ä¿¡å·åˆ†å¸ƒ: åŒ…å«1å’Œ-1 âœ“
- æ€»æ”¶ç›Šæ˜¾ç¤º âœ“
- å¹´åŒ–æ”¶ç›Šæ˜¾ç¤º âœ“

## ğŸ“ æ–‡ä»¶ç»“æ„
```
PulseTrader/
â”œâ”€â”€ pulse_trader/
â”‚   â”œâ”€â”€ data/__init__.py
â”‚   â”œâ”€â”€ data/source.py
â”‚   â”œâ”€â”€ strategies/__init__.py
â”‚   â”œâ”€â”€ strategies/ma_cross.py
â”‚   â”œâ”€â”€ backtest/__init__.py
â”‚   â””â”€â”€ backtest/engine.py
â””â”€â”€ scripts/mvp_test.py
```

**ğŸ¯ ç›®æ ‡**: ç”¨æœ€å°‘çš„ä»£ç å®ç°ä¸€ä¸ªå®Œæ•´çš„é‡åŒ–äº¤æ˜“æµç¨‹ï¼

å¦‚æœæµ‹è¯•é€šè¿‡ï¼Œè¯´æ˜ä½ çš„MVPæ¡†æ¶å·²ç»å¯ä»¥è¿è¡Œäº†ï¼ğŸš€